<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Monitoring Examples - https://softlayer.github.io/</title>
    <link rel="canonical" href="https://softlayer.github.io/python/monitoring/">
        <link href="https://softlayer.github.io/css/main.css" rel="stylesheet">
    <link href="https://softlayer.github.io/css/bootstrap.css" rel="stylesheet">
    <link href="https://softlayer.github.io/css/fa-svg-with-js.css" rel="stylesheet">
    <link href="https://softlayer.github.io/css/custom.css" rel="stylesheet">
    <link href="https://softlayer.github.io/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://softlayer.github.io/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://softlayer.github.io/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://softlayer.github.io/js/jquery-3.3.1.min.js"></script> 
    <script src="https://softlayer.github.io/js/sldn.js"></script>
    <script src="https://softlayer.github.io/js/fontawesome-all.js"></script>

    
	<script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-88235803-1', 'auto');
ga('send', 'pageview');
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://softlayer.github.io/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://softlayer.github.io/article/">Articles</a></li>
                    
                        <li><a href="https://softlayer.github.io/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://softlayer.github.io/go/">Go</a></li>
                    
                        <li><a href="https://softlayer.github.io/php/">PHP</a></li>
                    
                        <li><a href="https://softlayer.github.io/perl/">Perl</a></li>
                    
                        <li><a href="https://softlayer.github.io/python/">Python</a></li>
                    
                        <li><a href="https://softlayer.github.io/rest/">Rest</a></li>
                    
                        <li><a href="https://softlayer.github.io/ruby/">Ruby</a></li>
                    
                        <li><a href="https://softlayer.github.io/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:softlayer.github.io" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>October 12, 2016<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                    <a class="label label-primary" href="https://softlayer.github.io/classes/SoftLayer_Virtual_Guest">SoftLayer_Virtual_Guest</a>
                
                    <a class="label label-primary" href="https://softlayer.github.io/classes/SoftLayer_Hardware_Server">SoftLayer_Hardware_Server</a>
                
                    <a class="label label-primary" href="https://softlayer.github.io/classes/SoftLayer_Monitoring_Agent">SoftLayer_Monitoring_Agent</a>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://softlayer.github.io/tags/monitoring">monitoring</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm release-note" style="word-wrap: break-word;">
				<h3>Monitoring Examples<br> <small>A few examples on how to interact with SoftLayer Monitoring</small></h3>
				
                
				
                <p>ResponseStatus codes and what they mean.
<a href="http://sldn.softlayer.com/reference/datatypes/SoftLayer_Network_Monitor_Version1_Query_Result">http://sldn.softlayer.com/reference/datatypes/SoftLayer_Network_Monitor_Version1_Query_Result</a></p>

<ul>
<li>0: CRITICAL</li>
<li>1: Warning</li>
<li>2: OK<br /></li>
<li>4 - 5: Unknown Status, Contact Support</li>
</ul>

<p>More information:
<a href="https://stackoverflow.com/questions/37662607/python-api-monitoring-manager">https://stackoverflow.com/questions/37662607/python-api-monitoring-manager</a></p>

<p>This example gets the status of your Basic and Advanced monitoring.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> SoftLayer
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint <span style="color:#66d9ef">as</span> pp

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">example</span>():

    <span style="color:#66d9ef">def</span> __init__(self):

        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self):
        <span style="color:#66d9ef">return</span> True

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getBasicStatus</span>(self, server_id):
        mask <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;mask[fullyQualifiedDomainName, networkMonitors[lastResult]]&#34;</span>
        server <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>]<span style="color:#f92672">.</span>getObject(id<span style="color:#f92672">=</span>server_id, mask<span style="color:#f92672">=</span>mask )
        pp(server)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getAdvancedStatus</span>(self, server_id):
        mask <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;mask[fullyQualifiedDomainName, monitoringAgents[configurationValues[definition]]]&#34;</span>
        server <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>]<span style="color:#f92672">.</span>getObject(id<span style="color:#f92672">=</span>server_id, mask<span style="color:#f92672">=</span>mask )
        pp(server)

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;__main__&#34;</span>:
    server <span style="color:#f92672">=</span> <span style="color:#ae81ff">24880113</span>
    main <span style="color:#f92672">=</span> example()
    main<span style="color:#f92672">.</span>getBasicStatus(server)
    main<span style="color:#f92672">.</span>getAdvancedStatus(server)</code></pre></div>
<p>This example configures the CPU monitor</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&#34;&#34;&#34;
Configure the section &#39;CPU&#39; from the &#39;Cpu, Disk, and Memory Monitoring Agent&#39; agent.

Important manual pages
http://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest/findByIpAddress
http://sldn.softlayer.com/reference/services/SoftLayer_Hardware_Server/findByIpAddress
http://sldn.softlayer.com/reference/services/SoftLayer_Monitoring_Agent/applyConfigurationValues
http://sldn.softlayer.com/reference/datatypes/SoftLayer_Monitoring_Agent_Configuration_Value

License: http://sldn.softlayer.com/article/License
Author: SoftLayer Technologies, Inc. &lt;sldn@softlayer.com&gt;
&#34;&#34;&#34;

import SoftLayer
import json

# The IP address of the server or VSI to configure.
ipAddres = &#34;159.8.52.188&#34;

configuration = {
    &#39;Graph System CPU Usage&#39;: &#34;False&#34;,
    &#39;Graph Total CPU Usage&#39;: &#34;False&#34;,
    &#39;Graph User CPU Usage&#39;: &#34;True&#34;,
    &#39;Graph I/O Wait CPU Usage&#39;: &#34;True&#34;,
    &#39;Processor Queue Length Alarm&#39;: &#34;True&#34;,
    &#39;CPU Usage Error Alarm&#39;: &#34;True&#34;,
    &#39;CPU Usage Error Alarm Threshold&#39;: &#34;99&#34;,
    &#39;CPU Usage Warning Alarm&#39;: &#34;True&#34;,
    &#39;CPU Usage Warning Alarm Threshold&#39;: &#34;82&#34;,
    &#39;Processor Queue Length Alarm&#39;: &#34;True&#34;,
    &#39;Max Queue Length&#39;: &#34;4&#34;
}

# The agent&#39;s name we wish to configure.
agentName = &#39;Cpu, Disk, and Memory Monitoring Agent&#39;

client = SoftLayer.Client()
vsiService = client[&#39;SoftLayer_Virtual_Guest&#39;]
hardwareService = client[&#39;SoftLayer_Hardware_Server&#39;]
monitoringService = client[&#39;SoftLayer_Monitoring_Agent&#39;]

# Getting the monitoring agents installed in the server or VSI.
try:
    objectMask = &#39;mask[monitoringAgents[configurationValues[definition]]]&#39;
    server = vsiService.findByIpAddress(ipAddres, mask=objectMask)
    if not &#39;id&#39; in server:
        server = hardwareService.findByIpAddress(ipAddres, mask=objectMask)
        if not &#39;id&#39; in server:
            print(&#34;There is no a Server or VSI with the IP address: &#34; + ipAddres)
            exit(1)
except SoftLayer.SoftLayerAPIError as e:
    print(&#34;Unable to get the server &#34;
          % (e.faultCode, e.faultString))
    exit(1)

# Getting the agent to configure.
agents = [agent for agent in server[&#39;monitoringAgents&#39;] if agent[&#39;name&#39;] == agentName]
if len(agents) == 0:
    print(&#34;Unable to find the agent: &#34; + agentName)
    exit(1)
agent = agents[0]

# Creating an SoftLayer_Monitoring_Agent_Configuration_Value skeleton
# which contains the configuration for the agent.
configurationValues = []
for item in configuration.keys():
    itemFound = False
    for value in agent[&#39;configurationValues&#39;]:
        if value[&#39;definition&#39;][&#39;name&#39;].strip().upper() == item.strip().upper():
            itemFound = True
            configurationValue = value
            configurationValue[&#39;value&#39;] = configuration[item].strip().upper()
            configurationValues.append(configurationValue)
            break
    if not itemFound:
        print(&#34;The configuration: &#34; + item + &#34; is not available for the agent.&#34;)


# Calling the SoftLayer_Monitoring_Agent::applyConfigurationValues method
# to apply the changes in the agent.
# Note: In case there is no changes in the agent configuration the method
# will return error.
try:
    result = monitoringService.applyConfigurationValues(configurationValues, id=agent[&#39;id&#39;])
    print(json.dumps(result, sort_keys=True, indent=2, separators=(&#39;,&#39;, &#39;: &#39;)))
except SoftLayer.SoftLayerAPIError as e:
    print(&#34;Unable to apply the configuration in the monitoring agent.&#34;
          % (e.faultCode, e.faultString))
    exit(1)</pre></div>
<p>This example GETs the monitoring configuration</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">Get the configuration of the monitoring agent in a server or VSI.
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">Important manual pages:
</span><span style="color:#e6db74">http://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest/findByIpAddress
</span><span style="color:#e6db74">http://sldn.softlayer.com/reference/services/SoftLayer_Hardware_Server/findByIpAddress
</span><span style="color:#e6db74">http://sldn.softlayer.com/reference/datatypes/SoftLayer_Monitoring_Agent/
</span><span style="color:#e6db74">http://sldn.softlayer.com/article/Object-Masks
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">License: http://sldn.softlayer.com/article/License
</span><span style="color:#e6db74">Author: SoftLayer Technologies, Inc. &lt;sldn@softlayer.com&gt;
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#f92672">import</span> SoftLayer
<span style="color:#f92672">import</span> json

ipAddres <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;169.54.54.164&#34;</span>

client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()
vsiService <span style="color:#f92672">=</span> client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>]
hardwareService <span style="color:#f92672">=</span> client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;SoftLayer_Hardware_Server&#39;</span>]

<span style="color:#66d9ef">try</span>:
    objectMask <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;mask[monitoringAgents[configurationTemplate[configurationSections[subSections]],&#39;</span> \
                 <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configurationValues[id, value, profileId, agentId, configurationDefinitionId,&#39;</span> \
                 <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;profile, definition[attributes, section, valueType]]]]&#39;</span>
    server <span style="color:#f92672">=</span> vsiService<span style="color:#f92672">.</span>findByIpAddress(ipAddres, mask<span style="color:#f92672">=</span>objectMask)
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">in</span> server:
        server <span style="color:#f92672">=</span> hardwareService<span style="color:#f92672">.</span>findByIpAddress(ipAddres, mask<span style="color:#f92672">=</span>objectMask)
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">in</span> server:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;There is no a Server or VSI with the IP address: &#34;</span> <span style="color:#f92672">+</span> ipAddres)
            exit(<span style="color:#ae81ff">1</span>)
<span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>SoftLayerAPIError <span style="color:#66d9ef">as</span> e:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;Unable to get the server &#34;</span>
          <span style="color:#f92672">%</span> (e<span style="color:#f92672">.</span>faultCode, e<span style="color:#f92672">.</span>faultString))
    exit(<span style="color:#ae81ff">1</span>)

<span style="color:#75715e"># We will get the configuration of the active agents</span>
agents <span style="color:#f92672">=</span> [agent <span style="color:#66d9ef">for</span> agent <span style="color:#f92672">in</span> server[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;monitoringAgents&#39;</span>] <span style="color:#66d9ef">if</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;statusName&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;Active&#34;</span>]
server[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;monitoringAgents&#39;</span>] <span style="color:#f92672">=</span> agents

configs <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> agent <span style="color:#f92672">in</span> server[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;monitoringAgents&#39;</span>]:
    config <span style="color:#f92672">=</span> {}
    config[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;agent&#39;</span>] <span style="color:#f92672">=</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>]
    config[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span>] <span style="color:#f92672">=</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span>]
    sections <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> section <span style="color:#f92672">in</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configurationTemplate&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configurationSections&#39;</span>]:
        sect <span style="color:#f92672">=</span> {}
        subsects <span style="color:#f92672">=</span> []
        hasProfile <span style="color:#f92672">=</span> False
        profileIds <span style="color:#f92672">=</span> []
        confs <span style="color:#f92672">=</span> []
        <span style="color:#66d9ef">for</span> subsection <span style="color:#f92672">in</span> section[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;subSections&#39;</span>]:
            values <span style="color:#f92672">=</span> [value <span style="color:#66d9ef">for</span> value <span style="color:#f92672">in</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configurationValues&#39;</span>] <span style="color:#66d9ef">if</span>
                      value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;definition&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;sectionId&#39;</span>] <span style="color:#f92672">==</span> subsection[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span>]]
            <span style="color:#66d9ef">for</span> value <span style="color:#f92672">in</span> values:
                conf <span style="color:#f92672">=</span> {}
                <span style="color:#66d9ef">if</span> value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;profileId&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;</span>:
                    conf[value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;definition&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>]] <span style="color:#f92672">=</span> value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;value&#39;</span>]
                    confs<span style="color:#f92672">.</span>append(conf)
                <span style="color:#66d9ef">else</span>:
                    hasProfile <span style="color:#f92672">=</span> True
                    profileIds<span style="color:#f92672">.</span>append(value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;profileId&#39;</span>])      
        sect[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">=</span> section[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>]
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> hasProfile:
            sect[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configuration&#39;</span>] <span style="color:#f92672">=</span> confs
            sections<span style="color:#f92672">.</span>append(sect)
        <span style="color:#66d9ef">else</span>:
            profileIds <span style="color:#f92672">=</span> list(set(profileIds))
            profiles <span style="color:#f92672">=</span> []
            <span style="color:#66d9ef">for</span> profileId <span style="color:#f92672">in</span> profileIds:
                profile <span style="color:#f92672">=</span> {}
                valueConfs <span style="color:#f92672">=</span> []
                valueProfiles <span style="color:#f92672">=</span> [value <span style="color:#66d9ef">for</span> value <span style="color:#f92672">in</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configurationValues&#39;</span>] <span style="color:#66d9ef">if</span>
                                 value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;profileId&#39;</span>] <span style="color:#f92672">==</span> profileId]
                profile[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">=</span> valueProfiles[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;profile&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>]
                <span style="color:#66d9ef">for</span> valueProfile <span style="color:#f92672">in</span> valueProfiles:
                    value <span style="color:#f92672">=</span> {}
                    value[valueProfile[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;definition&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>]] <span style="color:#f92672">=</span> valueProfile[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;value&#39;</span>]
                    valueConfs<span style="color:#f92672">.</span>append(value)
                profile[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configuration&#39;</span>] <span style="color:#f92672">=</span> valueConfs
                profiles<span style="color:#f92672">.</span>append(profile)
            sect[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;profiles&#39;</span>] <span style="color:#f92672">=</span> profiles
            sections<span style="color:#f92672">.</span>append(sect)
    config[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;sections&#39;</span>] <span style="color:#f92672">=</span> sections
    configs<span style="color:#f92672">.</span>append(config)
<span style="color:#66d9ef">print</span>(json<span style="color:#f92672">.</span>dumps(configs, sort_keys<span style="color:#f92672">=</span>True, indent<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, separators<span style="color:#f92672">=</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;: &#39;</span>)))</code></pre></div>
<p>This example views the results of the monitoring</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">View the reports for the  &#34;CPU&#34; section from the
</span><span style="color:#e6db74">&#39;Cpu, Disk, and Memory Monitoring Agent&#39; monitor agent.
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">Important manual pages
</span><span style="color:#e6db74">http://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest/findByIpAddress
</span><span style="color:#e6db74">http://sldn.softlayer.com/reference/services/SoftLayer_Hardware_Server/findByIpAddress
</span><span style="color:#e6db74">http://sldn.softlayer.com/reference/services/SoftLayer_Monitoring_Agent/getGraphData
</span><span style="color:#e6db74">http://sldn.softlayer.com/reference/services/Monitoring_Agent_Configuration_Value/getMetricDataType
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">License: http://sldn.softlayer.com/article/License
</span><span style="color:#e6db74">Author: SoftLayer Technologies, Inc. &lt;sldn@softlayer.com&gt;
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#f92672">import</span> SoftLayer
<span style="color:#f92672">import</span> json

<span style="color:#75715e"># The IP address of the server or VSI to configure.</span>
ipAddres <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;159.8.52.188&#34;</span>

startDate <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;2016-01-02&#39;</span>
endDate <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;2016-01-08&#39;</span>

<span style="color:#75715e"># Set &#34;True&#34; the reports you wish to see.</span>
reports <span style="color:#f92672">=</span> {
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;Graph System CPU Usage&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;False&#34;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;Graph Total CPU Usage&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;False&#34;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;Graph User CPU Usage&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;False&#34;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;Graph I/O Wait CPU Usage&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;True&#34;</span>,
}

<span style="color:#75715e"># The agent&#39;s name we wish to see the reports.</span>
agentName <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;Cpu, Disk, and Memory Monitoring Agent&#39;</span>

client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()
vsiService <span style="color:#f92672">=</span> client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;SoftLayer_Virtual_Guest&#39;</span>]
hardwareService <span style="color:#f92672">=</span> client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;SoftLayer_Hardware_Server&#39;</span>]
monitoringService <span style="color:#f92672">=</span> client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;SoftLayer_Monitoring_Agent&#39;</span>]
agentConfigurationService <span style="color:#f92672">=</span> client[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;Monitoring_Agent_Configuration_Value&#39;</span>]

<span style="color:#75715e"># Getting the monitoring agents installed in the server or VSI.</span>
<span style="color:#66d9ef">try</span>:
    <span style="color:#75715e"># Setting an object mask to retrieve information about the monitoring agents.</span>
    objectMask <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;mask[monitoringAgents[configurationValues[definition]]]&#39;</span>
    server <span style="color:#f92672">=</span> vsiService<span style="color:#f92672">.</span>findByIpAddress(ipAddres, mask<span style="color:#f92672">=</span>objectMask)
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">in</span> server:
        server <span style="color:#f92672">=</span> hardwareService<span style="color:#f92672">.</span>findByIpAddress(ipAddres, mask<span style="color:#f92672">=</span>objectMask)
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">in</span> server:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;There is no a Server or VSI with the IP address: &#34;</span> <span style="color:#f92672">+</span> ipAddres)
            exit(<span style="color:#ae81ff">1</span>)
<span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>SoftLayerAPIError <span style="color:#66d9ef">as</span> e:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;Unable to get the server &#34;</span>
          <span style="color:#f92672">%</span> (e<span style="color:#f92672">.</span>faultCode, e<span style="color:#f92672">.</span>faultString))
    exit(<span style="color:#ae81ff">1</span>)

<span style="color:#75715e"># Getting the agent to see the reports.</span>
agents <span style="color:#f92672">=</span> [agent <span style="color:#66d9ef">for</span> agent <span style="color:#f92672">in</span> server[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;monitoringAgents&#39;</span>] <span style="color:#66d9ef">if</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">==</span> agentName]
<span style="color:#66d9ef">if</span> len(agents) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;Unable to find the agent: &#34;</span> <span style="color:#f92672">+</span> agentName)
    exit(<span style="color:#ae81ff">1</span>)
agent <span style="color:#f92672">=</span> agents[<span style="color:#ae81ff">0</span>]

<span style="color:#75715e"># Creating the list of SoftLayer_Container_Metric_Data_Type objects</span>
metricDataTypes <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> reports<span style="color:#f92672">.</span>keys():
    <span style="color:#66d9ef">if</span> reports[item]<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>upper() <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;TRUE&#34;</span>:
        itemFound <span style="color:#f92672">=</span> False
        <span style="color:#66d9ef">for</span> value <span style="color:#f92672">in</span> agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;configurationValues&#39;</span>]:
            <span style="color:#66d9ef">if</span> value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;definition&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>upper() <span style="color:#f92672">==</span> item<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>upper():
                itemFound <span style="color:#f92672">=</span> True
                <span style="color:#66d9ef">if</span> value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;value&#39;</span>]<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>upper() <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;TRUE&#34;</span>:
                    <span style="color:#66d9ef">try</span>:
                        metrics <span style="color:#f92672">=</span> agentConfigurationService<span style="color:#f92672">.</span>getMetricDataType(id<span style="color:#f92672">=</span>value[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span>])
                        metricDataTypes<span style="color:#f92672">.</span>append(metrics)
                    <span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>SoftLayerAPIError <span style="color:#66d9ef">as</span> e:
                        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;Unable to get the metrics. &#34;</span> <span style="color:#f92672">%</span> (e<span style="color:#f92672">.</span>faultCode, e<span style="color:#f92672">.</span>faultString))
                <span style="color:#66d9ef">else</span>:
                    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;The report: &#34;</span> <span style="color:#f92672">+</span> item <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34; is disable for the agent. Please review the agent configuration.&#34;</span>)
                    exit(<span style="color:#ae81ff">1</span>)
                <span style="color:#66d9ef">break</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> itemFound:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;The configuration: &#34;</span> <span style="color:#f92672">+</span> item <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34; is not available for the agent.&#34;</span>)

<span style="color:#75715e"># Getting the reports.</span>
<span style="color:#66d9ef">try</span>:
    data <span style="color:#f92672">=</span> monitoringService<span style="color:#f92672">.</span>getGraphData(metricDataTypes, startDate, endDate, id<span style="color:#f92672">=</span>agent[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;id&#39;</span>])
    <span style="color:#66d9ef">print</span>(json<span style="color:#f92672">.</span>dumps(data, sort_keys<span style="color:#f92672">=</span>True, indent<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, separators<span style="color:#f92672">=</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;: &#39;</span>)))
<span style="color:#66d9ef">except</span> SoftLayer<span style="color:#f92672">.</span>SoftLayerAPIError <span style="color:#66d9ef">as</span> e:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;Unable to get the report. &#34;</span>  <span style="color:#f92672">%</span> (e<span style="color:#f92672">.</span>faultCode, e<span style="color:#f92672">.</span>faultString))</code></pre></div>
            </div>
        </div>

    </div>
    <hr>
    <div class="row">
            
        <div class="col-md-6">
            
<div class="panel panel-default">
    <div class="panel-heading" style="padding: 2px 15px;">
        <h4>More Documentation</h4>
    </div>
    <div class="panel-body">
        <a href="https://softlayer.github.com/reference/softlayerapi"><i class="fa fa-link"></i> SoftLayer API Reference<br></a>
        <a href="https://github.com/softlayer/softlayer-java"><i class="fab fa-github"></i> softlayer-java<br></a>
        <a href="https://github.com/softlayer/softlayer-api-perl-client"><i class="fab fa-github"></i> softlayer-perl<br></a>
        <a href="https://github.com/softlayer/softlayer-api-php-client"><i class="fab fa-github"></i> softlayer-php<br></a>
        <a href="https://github.com/softlayer/softlayer-python"><i class="fab fa-github"></i> softlayer-python<br></a>
        <a href="https://github.com/softlayer/softlayer-ruby"><i class="fab fa-github"></i> softlayer-ruby<br></a>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading text-center" style="padding: 2px 15px;">
      <a href="https://www.facebook.com/IBMBluemixIaaS/"><i class="fab fa-facebook-square" alt="facebook"></i> </a>
      <a href="https://twitter.com/IBMBluemixIaaS"><i class="fab fa-twitter" alt="twitter"></i> </a>
      <a href="http://www.linkedin.com/company/softlayer-technologies-inc-" alt="linked-in"><i class="fab fa-linkedin"></i> </a>
      <a href="https://github.com/softlayer/softlayer.github.io"><i class="fab fa-github" alt="github"></i> </a>

    </div>
</div>

        </div>
        <div class="col-md-6">
            <div class="well well-sm" style="word-wrap: break-word;"> 
                <strong>Feedback? <span class="fa fa-comment"/></strong>
                    <p>
                        We would love to hear it<br>
                        <a class="" href="https://github.com/softlayer/api_examples/issues/new?title=Feedback%20for%20python%20-%20Monitoring%20Examples&body=Feedback+regarding%3A%20https%3a%2f%2fsoftlayer.github.io%2fpython%2fmonitoring%2f"><span class="fa fa-github-square"/> Open an issue</a>
                    </p>
            </div>
        </div>

    </div>
        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; SoftLayer 2015<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>

    <script src="https://softlayer.github.io/js/jquery.js"></script>
    <script src="https://softlayer.github.io/js/bootstrap.js"></script>
</body>
</html>

/python/monitoring/
