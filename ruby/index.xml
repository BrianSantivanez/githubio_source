<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
      <title>Ruby on SoftLayer API Examples </title>
    <link>https://softlayer.github.io/ruby/</link>
    <language>en-US</language>
    <author>Enthusiastic Hugo User</author>
    <rights>Copyright (c) 2014, Enthusiastic Hugo User; all rights reserved.</rights>
    <updated>Wed, 09 Aug 2017 00:00:00 UTC</updated>
    
    <item>
      <title>Add and remove rules in a Security group</title>
      <link>https://softlayer.github.io/ruby/addremovesecuritygrouprules/</link>
      <pubDate>Wed, 09 Aug 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/addremovesecuritygrouprules/</guid>
      <description>

&lt;p&gt;The Security Group offering is currently in Beta. The use of this feature is restricted to select users. When the Beta period is over, security groups will be available for all users. Contact sgbeta@us.ibm.com using ‘Security Groups’ in the subject line with any questions.&lt;/p&gt;

&lt;h3 id=&#34;adding-rules&#34;&gt;Adding Rules&lt;/h3&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;
=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)
secGroupId = 84301

# Create an object template to create the item.
objectTemplate = {
	&#39;direction&#39; =&amp;gt; &#39;ingress&#39;,
	&#39;protocol&#39; =&amp;gt; &#39;tcp&#39;,
	&#39;portRangeMin&#39; =&amp;gt; 22,
	&#39;portRangeMax&#39; =&amp;gt; 22,
	&#39;ethertype&#39; =&amp;gt; &#39;IPv4&#39;,
	&#39;remoteIp&#39; =&amp;gt; &#39;0.0.0.0/0&#39;
}

newRules = client[&#39;SoftLayer_Network_SecurityGroup&#39;].object_with_id(secGroupId).addRules([objectTemplate])
pp newRules
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;removing-rules&#34;&gt;Removing rules&lt;/h3&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;
=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)
secGroupId = 45101

# Create an object template to create the item.
objectTemplate = [ 48501, 48401 ]

remove = client[&#39;SoftLayer_Network_SecurityGroup&#39;].object_with_id(secGroupId).removeRules(objectTemplate)
pp remove
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Create a Security group</title>
      <link>https://softlayer.github.io/ruby/createsecuritygroup/</link>
      <pubDate>Wed, 09 Aug 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/createsecuritygroup/</guid>
      <description>&lt;p&gt;The Security Group offering is currently in Beta. The use of this feature is restricted to select users. When the Beta period is over, security groups will be available for all users. Contact sgbeta@us.ibm.com using ‘Security Groups’ in the subject line with any questions.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;
=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)
objectTemplate = { 
	&#39;name&#39; =&amp;gt; &#39;rubyExampleCreation&#39;,
    	&#39;description&#39; =&amp;gt; &#39;Sec Group created via ruby&#39;
}

createGroup = client[&#39;SoftLayer_Network_SecurityGroup&#39;].createObjects([objectTemplate])

pp createGroup
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Get Dedicated Host Allocation</title>
      <link>https://softlayer.github.io/ruby/getdedicatedhostallocation/</link>
      <pubDate>Wed, 09 Aug 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/getdedicatedhostallocation/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39; 
require &#39;pp&#39; 

# Connect to SoftLayer
client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

dedicated_host_id = 10501

getAllocStats = client[&#39;SoftLayer_Virtual_DedicatedHost&#39;].object_with_id(dedicated_host_id).getAllocationStatus

pp getAllocStats
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Get Dedicated Host Guests</title>
      <link>https://softlayer.github.io/ruby/getdedicatedhostguests/</link>
      <pubDate>Wed, 09 Aug 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/getdedicatedhostguests/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39; 
require &#39;pp&#39; 

# Connect to SoftLayer
client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

dedicated_host_id = 10501

getGuests = client[&#39;SoftLayer_Virtual_DedicatedHost&#39;].object_with_id(dedicated_host_id).getGuests
pp getGuests
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Get Security Group Details</title>
      <link>https://softlayer.github.io/ruby/getsecuritygroupdetails/</link>
      <pubDate>Wed, 09 Aug 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/getsecuritygroupdetails/</guid>
      <description>&lt;p&gt;The Security Group offering is currently in Beta. The use of this feature is restricted to select users. When the Beta period is over, security groups will be available for all users. Contact sgbeta@us.ibm.com using ‘Security Groups’ in the subject line with any questions.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;
=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)
secGroupId = 70501

getAll = client[&#39;SoftLayer_Network_SecurityGroup&#39;].object_with_id(secGroupId).getAllObjects
pp getAll
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Migrate a VSI between dedicated hosts</title>
      <link>https://softlayer.github.io/ruby/migratededicatedinstance/</link>
      <pubDate>Fri, 04 Aug 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/migratededicatedinstance/</guid>
      <description>&lt;p&gt;This script will kick of an immediate migration of the Virtual Guest.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;
=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39; 
require &#39;pp&#39; 

# Connect to SoftLayer
client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

destinationHostId = 10001
vsiId = 37167483

migrateGuest = client[&#39;SoftLayer_Virtual_Guest&#39;].object_with_id(vsiId).migrateDedicatedHost(destinationHostId)
pp migrateGuest
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Get Virtual Console Virtual Guest</title>
      <link>https://softlayer.github.io/ruby/getkvmdetails/</link>
      <pubDate>Thu, 04 May 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/getkvmdetails/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;=begin
@author Ryan Tiffany
=end

require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)
virtual_server_id = 31678643

mask = &#39;mask[consoleIpAddressRecord[ipAddress[ipAddress],port],operatingSystem[passwords]]&#39;

getDetails = client[&#39;SoftLayer_Virtual_Guest&#39;].object_mask(mask).object_with_id(virtual_server_id).getObject
pp getDetails
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Show storage on all Virtual Guests</title>
      <link>https://softlayer.github.io/ruby/listvsiblockdevicesizes/</link>
      <pubDate>Mon, 03 Apr 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/listvsiblockdevicesizes/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;softlayer_api&#39;
require &#39;pp&#39;

# Create a SoftLayer API client object
client = SoftLayer::Client.new()

account_service = client[&#39;SoftLayer_Account&#39;]

# We will retrieve the additional information for each VSI:
mask = &#39;mask[id,hostname,blockDevices[id,mountType,diskImage[capacity]]]&#39;
begin
  # getVirtualGuests() will get all the VSIs that an account has.
  result = account_service.object_mask(mask).getVirtualGuests
  pp result
rescue StandardError =&amp;gt; exception
  puts &amp;quot;Unable to  get the VSIs: #{exception}&amp;quot;
end
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Get Notifications</title>
      <link>https://softlayer.github.io/ruby/getnotifications/</link>
      <pubDate>Sun, 02 Apr 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/getnotifications/</guid>
      <description>&lt;p&gt;Retrieves all notifications that were created on January 1, 2016.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

theDate = &#39;01/01/2017 01:00:00&#39;
theFilter = {
                &#39;startDate&#39;=&amp;gt; { 
                    &#39;operation&#39;=&amp;gt; &#39;greaterThanDate&#39;,
                    &#39;options&#39;=&amp;gt; [
                        {&#39;name&#39;=&amp;gt; &#39;date&#39;, &#39;value&#39; =&amp;gt; [theDate]}
                    ]
                }
            }



getresults = client[&#39;SoftLayer_Notification_Occurrence_Event&#39;].getAllObjects(filter=theFilter)
pp getresults
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Reload with SSH keys</title>
      <link>https://softlayer.github.io/ruby/reloadwithsshhardware/</link>
      <pubDate>Sun, 02 Apr 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/reloadwithsshhardware/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

imageId = 1234567
sshKey1 = 876543
sshKey2 = 456789
serverId = 1154265
        config = {
            &#39;imageTemplateId&#39;=&amp;gt; imageId, 
            &#39;sshKeyIds&#39; =&amp;gt; [sshKey1, sshKey2]
        }

setclient = client[&#39;Hardware_Server&#39;]
reload = setclient.object_with_id(serverId).reloadOperatingSystem(&#39;FORCE&#39;, config)
pp reload	        
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Order a Netscaler</title>
      <link>https://softlayer.github.io/ruby/ordernetscaler/</link>
      <pubDate>Fri, 31 Mar 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/ordernetscaler/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

config = { 
    &#39;orderContainers&#39; =&amp;gt; [
        {&amp;quot;hardware&amp;quot; =&amp;gt; [{
            &amp;quot;primaryBackendNetworkComponent&amp;quot; =&amp;gt; {
                    # REPLACE THIS
                    &amp;quot;networkVlanId&amp;quot; =&amp;gt; 1211234
                },
                &amp;quot;primaryNetworkComponent&amp;quot; =&amp;gt; {
                    # REPLACE THIS
                    &amp;quot;networkVlanId&amp;quot; =&amp;gt; 1212456
                }
            }],
            # REPLACE THIS with your location
            &amp;quot;location&amp;quot; =&amp;gt; &amp;quot;DALLAS09&amp;quot;,
            &amp;quot;packageId&amp;quot; =&amp;gt; 192,
            &amp;quot;quantity&amp;quot; =&amp;gt; 1,
            # Price IDS for Netscaler and 2 IPs
            &amp;quot;prices&amp;quot; =&amp;gt; [
                {&amp;quot;id&amp;quot; =&amp;gt; 44964},
                {&amp;quot;id&amp;quot; =&amp;gt; 17238}
            ]
            }]
        }

order = client[&#39;Product_Order&#39;].verifyOrder(config)

pp order    
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Reloading a server with a custom partition scheme</title>
      <link>https://softlayer.github.io/ruby/reloadcustompartition/</link>
      <pubDate>Fri, 31 Mar 2017 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/reloadcustompartition/</guid>
      <description>&lt;p&gt;The following code allows you to reload a Bare Metal server with a custom partitioning scheme. You simply need to change the serverId and the partitions to suit your needs. Note that one partition must be marked as the &amp;lsquo;grow&amp;rsquo; partition.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)
server_id = 1154505

config = { 

    &#39;upgradeHardDriveFirmware&#39; =&amp;gt; 0,
        &#39;upgradeBios&#39; =&amp;gt; 0,
        &#39;hardDrives&#39; =&amp;gt; [
            {
                &#39;complexType&#39; =&amp;gt; &amp;quot;SoftLayer_Hardware_Component_HardDrive&amp;quot;,
                &#39;partitions&#39; =&amp;gt; [
                    { &#39;name&#39; =&amp;gt; { &amp;quot;/&amp;quot; =&amp;gt; { &amp;quot;minimumSize&amp;quot; =&amp;gt; &amp;quot;100&amp;quot;} } },
                    { &#39;name&#39; =&amp;gt; { &amp;quot;/boot&amp;quot; =&amp;gt; { &amp;quot;minimumSize&amp;quot; =&amp;gt; &amp;quot;.25&amp;quot; } } },
                    { &#39;name&#39; =&amp;gt; { &amp;quot;/swap0&amp;quot; =&amp;gt; { &amp;quot;minimumSize&amp;quot; =&amp;gt; &amp;quot;32&amp;quot;} } },
                    { &#39;name&#39; =&amp;gt; { &amp;quot;/tmp&amp;quot; =&amp;gt; { &amp;quot;minimumSize&amp;quot; =&amp;gt; &amp;quot;100&amp;quot;} } },
                    { &#39;name&#39; =&amp;gt; { &amp;quot;/var&amp;quot; =&amp;gt; { &amp;quot;minimumSize&amp;quot; =&amp;gt; &amp;quot;100&amp;quot;} } },
                    { &#39;name&#39; =&amp;gt; { &amp;quot;/remove&amp;quot; =&amp;gt; { &amp;quot;minimumSize&amp;quot; =&amp;gt; &amp;quot;1&amp;quot;, &amp;quot;grow&amp;quot; =&amp;gt; &amp;quot;1&amp;quot; } } } 
                ]
            }
        ]
     }

setclient = client[&#39;Hardware_Server&#39;]
reload = setclient.object_with_id(server_id).reloadOperatingSystem(&#39;FORCE&#39;, config)

pp reload

&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Get verbose details about a Bare Metal Server</title>
      <link>https://softlayer.github.io/ruby/getverbosebmdetails/</link>
      <pubDate>Thu, 29 Dec 2016 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/getverbosebmdetails/</guid>
      <description>&lt;p&gt;This script will get the Packages, Categories, and items associated with a Bare Metal Server.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;
require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

hardware_id = 26961063
object_mask = &#39;mask[id,fullyQualifiedDomainName,billingItem[id,item[id,description],category[name,id],children[id,item[id,description],category[name,id]]]]&#39;

getDetails = client[&#39;SoftLayer_Hardware&#39;].object_mask(object_mask).object_with_id(hardware_id).getObject
pp getDetails

&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Get verbose details about a Virtual Guest</title>
      <link>https://softlayer.github.io/ruby/getverbosevsidetails/</link>
      <pubDate>Thu, 29 Dec 2016 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/getverbosevsidetails/</guid>
      <description>&lt;p&gt;This script will get the Packages, Categories, and items associated with a Virtual Guest.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;softlayer_api&#39;
require &#39;pp&#39;

client = SoftLayer::Client.new(:timeout =&amp;gt; 120)

virtual_server_id = 26961063
object_mask = &#39;mask[id,fullyQualifiedDomainName,billingItem[id,item[id,description],category[name,id],children[id,item[id,description],category[name,id]]]]&#39;

getDetails = client[&#39;SoftLayer_Virtual_Guest&#39;].object_mask(object_mask).object_with_id(virtual_server_id).getObject
pp getDetails
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Migrating a VSI from SAN to Local Storage and vice-versa</title>
      <link>https://softlayer.github.io/ruby/migratevsi/</link>
      <pubDate>Mon, 07 Nov 2016 00:00:00 UTC</pubDate>
      <author>Enthusiastic Hugo User</author>
      <guid>https://softlayer.github.io/ruby/migratevsi/</guid>
      <description>&lt;p&gt;You can use the following &lt;a href=&#34;https://softlayer.github.io/ruby/list_packages/&#34;&gt;ruby example&lt;/a&gt; to get a list of all the available priceId&amp;rsquo;s for the Virtual_Guest package. You need to change the second to last line from main.getPackage(126) to main.getPackage(46). The priceId you need will depend on if you are moving to or from Local Storage and the size of the current primary drive.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;
require &#39;softlayer_api&#39;
require &#39;pp&#39;

softlayer_client = SoftLayer::Client.new(:timeout =&amp;gt; 120)
client = softlayer_client.service_named(&#39;Product_Order&#39;)

# The package for Virtual Guests
packageId = 46

# The price item id for a 25GB Local Primary Drive.
prices = [
{
  &#39;id&#39; =&amp;gt; 13899,
    &#39;categories&#39; =&amp;gt; [
       {
           &#39;categoryCode&#39; =&amp;gt; &#39;guest_disk0&#39;,
           &#39;id&#39; =&amp;gt; 81,
           &#39;name&#39; =&amp;gt; &#39;First Disk&#39;
       }
   ]
  }
]

# Maintenance Window time. The migration requires downtime
properties = [
  {
      &#39;name&#39; =&amp;gt; &#39;MAINTENANCE_WINDOW&#39;,
      &#39;value&#39; =&amp;gt; &#39;now&#39;
  }
]

productOrder = {
  &#39;complexType&#39; =&amp;gt; &#39;SoftLayer_Container_Product_Order_Virtual_Guest_Upgrade&#39;,
  &#39;packageId&#39; =&amp;gt; packageId,
  &#39;prices&#39; =&amp;gt; prices,
  &#39;properties&#39; =&amp;gt; properties,
  &#39;virtualGuests&#39; =&amp;gt; [ {&#39;id&#39; =&amp;gt; &#39;25367125&#39;} ]
}

begin
 # verifyOrder() will check your order for errors. Replace this with a call to
 # placeOrder() when you&#39;re ready to order. Both calls return a receipt object
 # that you can use for your records.
 #
 # Once your order is placed it&#39;ll go through SoftLayer&#39;s provisioning process.

 receipt = client.verifyOrder(productOrder)
 puts receipt
rescue Exception =&amp;gt; exception
 puts &amp;quot;There is an error in the order: #{exception}&amp;quot;
end
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>